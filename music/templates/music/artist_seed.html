<!-- music/templates/music/artist_seed.html -->

{% extends 'music/base.html' %}

{% block title %}First Recommendations - Sonder{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome to Sonder</h1>
    <p>List some artists that you like to help our algorithm get started</p>
    <form method="POST" action="{% url 'music:artist_seed' %}" id="artist-form">  <!-- Ensure method="POST" is here -->
        {% csrf_token %}

        <!-- Artist 1 Input (Always Visible) -->
        <div class="artist-input" id="artist-input-1">
            {{ form.artist_1 }}
        </div>

        <!-- Artist 2-5 Inputs (Hidden Initially) -->
        <div class="artist-input" id="artist-input-2" style="display: none;">
            {{ form.artist_2 }}
        </div>
        <div class="artist-input" id="artist-input-3" style="display: none;">
            {{ form.artist_3 }}
        </div>
        <div class="artist-input" id="artist-input-4" style="display: none;">
            {{ form.artist_4 }}
        </div>
        <div class="artist-input" id="artist-input-5" style="display: none;">
            {{ form.artist_5 }}
        </div>

        <!-- Button Container -->
        <div class="button-container">
            <button id="add-artist-btn" type="button">Add Artist</button>
            <button class="submit-btn" type="submit">Submit</button>  <!-- Submit button submits as POST -->
        </div>

    </form>
    
    <!-- Messages Display -->
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
</div>

<!-- JavaScript for Revealing Hidden Input Fields -->
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const addArtistBtn = document.getElementById('add-artist-btn');
        const maxArtists = 5;
        let currentArtist = 1;

        addArtistBtn.addEventListener('click', function() {
            if (currentArtist < maxArtists) {
                currentArtist += 1;
                const nextInputDiv = document.getElementById(`artist-input-${currentArtist}`);
                if (nextInputDiv) {
                    nextInputDiv.style.display = 'block';
                }

                if (currentArtist === maxArtists) {
                    addArtistBtn.disabled = true;
                    addArtistBtn.style.backgroundColor = '#6c757d';
                    addArtistBtn.style.cursor = 'not-allowed';
                }
            }
        });
    });
</script>
{% endblock %}
{% endblock %}
