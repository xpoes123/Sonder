<!-- music/templates/music/home.html -->

{% extends 'music/base.html' %}

{% block title %}Home - Sonder{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome to Sonder</h1>
    <p>Your personalized music recommendation platform.</p>
    <form method="POST" action="{% url 'music:recommend' %}" id="artist-form">
        {% csrf_token %}
        
        <div class="artist-input" id="artist-input-1">
            {{ form.artist_1 }}
        </div>
        
        <!-- Additional Artist Inputs will be appended here -->
        
        <button type="button" id="add-artist-btn">Add Artist</button>
        <button type="submit" class="submit-btn">Get Recommendations</button>
    </form>
    
    <!-- Messages Display -->
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li class="{{ message.tags }}">{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
</div>

<!-- JavaScript for Dynamic Input Fields -->
{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Dynamic Artist Input Fields
        const addArtistBtn = document.getElementById('add-artist-btn');
        const form = document.getElementById('artist-form');
        let artistCount = 1;
        const maxArtists = 5;

        addArtistBtn.addEventListener('click', function() {
            if (artistCount < maxArtists) {
                artistCount += 1;
                const newInputDiv = document.createElement('div');
                newInputDiv.classList.add('artist-input');
                newInputDiv.id = `artist-input-${artistCount}`;
                
                // Create the new input field
                const newInput = document.createElement('input');
                newInput.type = 'text';
                newInput.name = `artist_${artistCount}`;
                newInput.placeholder = `Artist ${artistCount}`;
                newInput.required = false;
                
                // Optionally, add label (hidden for accessibility)
                const label = document.createElement('label');
                label.textContent = `Artist ${artistCount}:`;
                label.setAttribute('for', `id_artist_${artistCount}`);
                label.style.display = 'none'; // Hide label if not needed

                newInputDiv.appendChild(label);
                newInputDiv.appendChild(newInput);
                
                // Insert the new input before the Add Artist button
                form.insertBefore(newInputDiv, addArtistBtn);
                
                // Disable Add Artist button if max reached
                if (artistCount === maxArtists) {
                    addArtistBtn.disabled = true;
                }
            }
        });
    });
</script>
{% endblock %}
{% endblock %}
